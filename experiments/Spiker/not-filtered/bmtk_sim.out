/home/mwsrgf/act-venv/lib64/python3.9/site-packages/torch/__init__.py:955: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:432.)
  _C._set_default_tensor_type(t)
Warning: no DISPLAY environment variable.
--No graphics will be displayed.
Blocking: []
Total number of jobs: 3
Total number of proccessors: 192
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/42/target/synthetic_0.1_0.2_0.3_
RUNNING THE MODULE
LOADING TARGET TRACES
SIMULATING TRAINING DATA
Total number of jobs: 3000
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/42/final/train
TRAINING RANDOM FOREST REGRESSOR
Extracting features: ['I_mean', 'I_stdev', 'Num Spikes', 'Spike Time 1', 'Spike Time 2', 'Spike Time 3', 'Spike Time 4', 'Spike Time 5', 'Spike Time 6', 'Spike Time 7', 'Spike Time 8', 'Spike Time 9', 'Spike Time 10', 'Spike Time 11', 'Spike Time 12', 'Spike Time 13', 'Spike Time 14', 'Spike Time 15', 'Spike Time 16', 'Spike Time 17', 'Spike Time 18', 'Spike Time 19', 'Spike Time 20', 'Min Spike Height', 'Max Spike Height', 'Avg Spike Height', 'Std Spike Height', 'Num Troughs', 'Trough Time 1', 'Trough Time 2', 'Trough Time 3', 'Trough Time 4', 'Trough Time 5', 'Trough Time 6', 'Trough Time 7', 'Trough Time 8', 'Trough Time 9', 'Trough Time 10', 'Trough Time 11', 'Trough Time 12', 'Trough Time 13', 'Trough Time 14', 'Trough Time 15', 'Trough Time 16', 'Trough Time 17', 'Trough Time 18', 'Trough Time 19', 'Trough Time 20', 'Min Trough Height', 'Max Trough Height', 'Avg Trough Height', 'Std Trough Height']
Evaluating random forest
MAE: 0.076793 (0.001863)
Saving rf mean/stdev scores to output/Spiker_Original_sl-10/42/final/results/saved_metrics.json
Predicted Conductances for each current injection intensity: 
[[8.58666667e-02 1.25000000e-01 0.00000000e+00]
 [8.96333333e-02 1.63733333e-01 3.33333333e-05]
 [8.65333333e-02 1.55566667e-01 0.00000000e+00]]
SIMULATING PREDICTIONS
Total number of jobs: 9
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/42/final/prediction_eval0
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/42/final/prediction_eval1
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/42/final/prediction_eval2
SELECTING BEST PREDICTION
FI curve MAE for each prediction: 
[77.77777777777779, 77.77777777777779, 77.77777777777779]
{'gnabar_hh_seg': 0.0858666666666666, 'gkbar_hh_seg': 0.12499999999999975, 'gl_hh_seg': 0.0}
Module runtime: 0:00:22.380103
Interspike times (Target): [[15.8 15.5 15.5 15.5]
 [12.7 12.3 12.2 12.2]
 [11.3 10.8 10.7 10.7]]
Interspike times (Prediction): [[1000000. 1000000. 1000000. 1000000.]
 [1000000. 1000000. 1000000. 1000000.]
 [1000000. 1000000. 1000000. 1000000.]]
MAE for each I injection: [999984.425, 999987.6499999999, 999989.125]
Mean interspike-interval MAE: 999987.0666666668
Standard Deviation interspike-interval MAE: 1.9626017312326332
MAE of final g prediction: 0.04114444444444438
MAE of summary features for final prediction: 590868.6009948421
Smallest FI MAE values (gkbar_hh_orig, gl_hh_orig, FI MAE): 
[[0.1        0.03333333 2.22222222]
 [0.3        0.06666667 3.33333333]
 [0.13333333 0.03333333 5.55555556]
 [0.23333333 0.06666667 5.55555556]
 [0.26666667 0.06666667 5.55555556]
 [0.23333333 0.03333333 6.66666667]]
Smallest MAE values (gkbar_hh_orig, gl_hh_orig, V MAE): 
[[ 0.13333333  0.06666667 13.27549809]
 [ 0.1         0.06666667 13.3334279 ]
 [ 0.2         0.1        13.3542192 ]
 [ 0.06666667  0.06666667 13.39197557]
 [ 0.03333333  0.03333333 13.39377043]
 [ 0.16666667  0.1        13.40295397]]
Smallest MAE values (gkbar_hh_orig, gl_hh_orig, Summary Stats MAE): 
[[1.00000000e-01 3.33333333e-02 2.43417493e+00]
 [3.00000000e-01 6.66666667e-02 5.25147903e+00]
 [1.33333333e-01 3.33333333e-02 6.41417361e+03]
 [1.66666667e-01 3.33333333e-02 6.41575004e+03]
 [2.33333333e-01 6.66666667e-02 6.41650608e+03]
 [2.00000000e-01 3.33333333e-02 6.41669157e+03]]
Blocking: []
Total number of jobs: 3
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/43/target/synthetic_0.1_0.2_0.3_
RUNNING THE MODULE
LOADING TARGET TRACES
SIMULATING TRAINING DATA
Total number of jobs: 3000
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/43/final/train
TRAINING RANDOM FOREST REGRESSOR
Extracting features: ['I_mean', 'I_stdev', 'Num Spikes', 'Spike Time 1', 'Spike Time 2', 'Spike Time 3', 'Spike Time 4', 'Spike Time 5', 'Spike Time 6', 'Spike Time 7', 'Spike Time 8', 'Spike Time 9', 'Spike Time 10', 'Spike Time 11', 'Spike Time 12', 'Spike Time 13', 'Spike Time 14', 'Spike Time 15', 'Spike Time 16', 'Spike Time 17', 'Spike Time 18', 'Spike Time 19', 'Spike Time 20', 'Min Spike Height', 'Max Spike Height', 'Avg Spike Height', 'Std Spike Height', 'Num Troughs', 'Trough Time 1', 'Trough Time 2', 'Trough Time 3', 'Trough Time 4', 'Trough Time 5', 'Trough Time 6', 'Trough Time 7', 'Trough Time 8', 'Trough Time 9', 'Trough Time 10', 'Trough Time 11', 'Trough Time 12', 'Trough Time 13', 'Trough Time 14', 'Trough Time 15', 'Trough Time 16', 'Trough Time 17', 'Trough Time 18', 'Trough Time 19', 'Trough Time 20', 'Min Trough Height', 'Max Trough Height', 'Avg Trough Height', 'Std Trough Height']
Evaluating random forest
MAE: 0.076812 (0.001598)
Saving rf mean/stdev scores to output/Spiker_Original_sl-10/43/final/results/saved_metrics.json
Predicted Conductances for each current injection intensity: 
[[0.0858     0.12243333 0.        ]
 [0.088      0.1564     0.        ]
 [0.08613333 0.14973333 0.        ]]
SIMULATING PREDICTIONS
Total number of jobs: 9
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/43/final/prediction_eval0
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/43/final/prediction_eval1
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/43/final/prediction_eval2
SELECTING BEST PREDICTION
FI curve MAE for each prediction: 
[77.77777777777779, 77.77777777777779, 77.77777777777779]
{'gnabar_hh_seg': 0.0857999999999998, 'gkbar_hh_seg': 0.12243333333333294, 'gl_hh_seg': 0.0}
Module runtime: 0:00:20.056401
Interspike times (Target): [[15.8 15.5 15.5 15.5]
 [12.7 12.3 12.2 12.2]
 [11.3 10.8 10.7 10.7]]
Interspike times (Prediction): [[1000000. 1000000. 1000000. 1000000.]
 [1000000. 1000000. 1000000. 1000000.]
 [1000000. 1000000. 1000000. 1000000.]]
MAE for each I injection: [999984.425, 999987.6499999999, 999989.125]
Mean interspike-interval MAE: 999987.0666666668
Standard Deviation interspike-interval MAE: 1.9626017312326332
MAE of final g prediction: 0.04031111111111105
MAE of summary features for final prediction: 590868.617447413
Smallest FI MAE values (gkbar_hh_orig, gl_hh_orig, FI MAE): 
[[0.1        0.03333333 2.22222222]
 [0.3        0.06666667 3.33333333]
 [0.13333333 0.03333333 5.55555556]
 [0.23333333 0.06666667 5.55555556]
 [0.26666667 0.06666667 5.55555556]
 [0.23333333 0.03333333 6.66666667]]
Smallest MAE values (gkbar_hh_orig, gl_hh_orig, V MAE): 
[[ 0.13333333  0.06666667 13.27549809]
 [ 0.1         0.06666667 13.3334279 ]
 [ 0.2         0.1        13.3542192 ]
 [ 0.06666667  0.06666667 13.39197557]
 [ 0.03333333  0.03333333 13.39377043]
 [ 0.16666667  0.1        13.40295397]]
Smallest MAE values (gkbar_hh_orig, gl_hh_orig, Summary Stats MAE): 
[[1.00000000e-01 3.33333333e-02 2.43417493e+00]
 [3.00000000e-01 6.66666667e-02 5.25147903e+00]
 [1.33333333e-01 3.33333333e-02 6.41417361e+03]
 [1.66666667e-01 3.33333333e-02 6.41575004e+03]
 [2.33333333e-01 6.66666667e-02 6.41650608e+03]
 [2.00000000e-01 3.33333333e-02 6.41669157e+03]]
Blocking: []
Total number of jobs: 3
Total number of proccessors: 192
MECHANISMS already loaded.
/home/mwsrgf/proj/ACT/experiments/Spiker/not-filtered/output/Spiker_Original_sl-10/44/target/synthetic_0.1_0.2_0.3_
RUNNING THE MODULE
LOADING TARGET TRACES
SIMULATING TRAINING DATA
Total number of jobs: 3000
Total number of proccessors: 192
MECHANISMS already loaded.
slurmstepd: error: *** JOB 13504 ON engr-nelvm-res CANCELLED AT 2024-10-29T13:33:34 ***
/home/mwsrgf/act-venv/lib64/python3.9/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 1 leaked file objects to clean up at shutdown
  warnings.warn(
/home/mwsrgf/act-venv/lib64/python3.9/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 198 leaked semlock objects to clean up at shutdown
  warnings.warn(
/home/mwsrgf/act-venv/lib64/python3.9/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 4 leaked folder objects to clean up at shutdown
  warnings.warn(
